<html>
    <head>
      <title>Air Traffic Control Simulation</title>

<script>
  function loadTable()
  {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
              var listObj = JSON.parse(this.responseText);
              var tableContents = "<tr><th>Name</th><th>Type</th><th>Size</th></tr>";
              if ((listObj) && (Array.isArray(listObj))) {
                  for (var i = 0; i < listObj.length; i++) {
                      tableContents += "<tr><td>" + listObj[i].name + "</td><td>" + listObj[i].type +
                          "</td><td>" + listObj[i].size + "</td></tr>";
                  }
              }
              document.getElementById("queueTable").innerHTML = tableContents;
          }
      };
      xhttp.open("GET", "/", true);
      xhttp.send();
  }

  function addToQueue(obj)
  {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
              document.getElementById("status").innerHTML = this.responseText;
          }
      };
      xhttp.open("POST", "/", true);
      xhttp.setRequestHeader("Content-type", "application/json");
      xhttp.send(JSON.stringify(obj));
  }

  function removeFromQueue()
  {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
              var contents = "empty queue";
              if (this.responseText != "") {
                  var planeObj = JSON.parse(this.responseText);
                  if (planeObj) {
                      contents = "Name: " + planeObj.name + "<br/>Type: " + planeObj.type + "<br/>Size: " + planeObj.size;
                  }
              }
              document.getElementById("next").innerHTML = contents;
          }
      };
      xhttp.open("DELETE", "/", true);
      xhttp.send();
  }

  function addPlane()
  {
      var pName = document.getElementById("name").value;
      var pType = document.getElementById("type").value;
      var pSize = document.getElementById("size").value;
      var obj = { name: pName, type: pType, size: pSize };
      addToQueue(obj);
      setTimeout(loadTable, 1000);
  }

  function getNextPlane()
  {
      document.getElementById("status").innerHTML = "Getting next plane";
      removeFromQueue();
      setTimeout(loadTable, 1000);
  }
</script>
      
    </head>
    <body onload="loadTable()">
        <h2>Air Traffic Control Simulation</h2>
        <p>Add aircraft to queue:&nbsp;&nbsp;
          Name: <input id="name" type="text"></input>
          Type: <select id="type"><option>Emergency</option><option>VIP</option><option>Passenger</option><option>Cargo</option></select>
          Size: <select id="size"><option>Small</option><option>Large</option></select>
          <input type="button" value="Add Aircraft to Queue" onclick="addPlane()" />
        </p>
        <p>
            <table border="2" id="queueTable">
                <tr><th>Name</th><th>Type</th><th>Size</th></tr>
            </table>
        </p>
        <p>
            Get next aircraft from queue: <input type="button" value="Get Aircraft" onclick="getNextPlane()" /><br/>
            <span id="next"></span>
        </p>
        <p id="status"></p>
    </body>
</html>
